<!DOCTYPE html>
<meta charset="utf-8">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

    <script>
        L_NO_TOUCH = false;
        L_DISABLE_3D = false;
    </script>

    <style>
        /* html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        } */
    </style>
    <style>
        /* #map {
            display: flex;
            position: relative;
            width: 100%;
            height: 100%;
            top: 0;
            bottom: 0;
            right: 0;
            left: 0;
        } */
    </style>
    <script src="./js/leaflet.js"></script>
    <script src="./js/jquery-3.6.0.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/leaflet.awesome-markers.js"></script>
    <script src="./js/resizable.js"></script>
    <script src="./js/sortable-table.js"></script>
    <script src="./js/slider-multithumb.js"></script>
    <script src="./js/mycmaps.js"></script>
    <script src="./js/select-only.js"></script>
    <script src="./js/plotly.js"></script>
    <script src="./js/kriging.js"></script>
    <script src="./js/proj4.js"></script>
    <script src="./js/fontawesome.js"></script>
    <script type="text/javascript" src="./o3dv/o3dv.min.js"></script>
    <script type="text/javascript">
        // Set the external libraries location to the
        // folder where the library is.
        OV.SetExternalLibLocation ('./o3dv/libs');

        // Init all the 3d viewer elements.
        OV.Init3DViewerElements ();
    </script>

    <!-- <script src="./js/hexbin.js"></script>     -->
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <!-- <script src="https://d3js.org/d3.v6.js"></script> -->
    <script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
    <script src="./js/leaflet-d3.js"></script>

    <link rel="stylesheet" href="./css/resizable-style.css" />
    <link rel="stylesheet" href="./css/leaflet.css" />
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <link rel="stylesheet" href="./css/bootstrap.min.css.map" />
    <link rel="stylesheet" href="./css/bootstrap-theme.min.css" />
    <link rel="stylesheet" href="./css/font-awesome.min.css" />
    <link rel="stylesheet" href="./css/leaflet.awesome-markers.css" />
    <link rel="stylesheet" href="./css/leaflet.awesome.rotate.min.css" />
    <link rel="stylesheet" href="./css/sortable-table.css" />
    <link rel="stylesheet" href="./css/slider-multithumb.css" />
    <link rel="stylesheet" href="./css/select-only.css" />

    <!-- <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> -->
                <meta name="viewport" content="width=1024">

    <style>
        #map_16d19f0c4cb02d0360d2d91f78fb101a {
            display: flex;
            position: relative;
            width: 50.0%;
            height: 50.0%;
            left: 0.0%;
            top: 0.0%;

        }

        .hexbin-hexagon {
            stroke: #000;
            stroke-width: .5px;
        }

        .hexbin-container:hover .hexbin-hexagon {
            transition: 200ms;
            stroke: orange;
            stroke-width: 1px;
            stroke-opacity: 1;
        }

        .hexbin-tooltip {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid black;
            background-color: white;
        }

        .tabs {
            font-family: "lucida grande", sans-serif;
        }

        [role="tablist"] {
            min-width: 250px;
        }

        [role="tab"],
        [role="tab"]:focus,
        [role="tab"]:hover {
            position: relative;
            z-index: 2;
            top: 2px;
            margin: 0;
            margin-top: 4px;
            padding: 3px 3px 4px;
            border: 1px solid rgb(33 37 41);
            border-bottom: 2px solid rgb(33 37 41);
            border-radius: 5px 5px 0 0;
            overflow: visible;
            background: hsl(220deg 20% 94%);
            outline: none;
            font-weight: bold;
            font-size: small;
        }

        [role="tab"][aria-selected="true"] {
            color: hsl(220deg 20% 94%);
            padding: 2px 2px 4px;
            margin-top: 0;
            border-width: 2px;
            border-top-width: 6px;
            border-radius: 5px 5px 0 0;
            border: 1px solid hsl(220deg 20% 94%);
            border-bottom-color: rgb(33 37 41);
            background: rgb(33 37 41);

        }

        [role="tab"][aria-selected="false"] {
            border-bottom: 1px solid rgb(33 37 41);

        }

        [role="tab"] span.focus {
            display: inline-block;
            margin: 2px;
            padding: 4px 6px;
        }

        [role="tab"]:hover span.focus,
        [role="tab"]:focus span.focus,
        [role="tab"]:active span.focus {
            padding: 2px 4px;
            border: 2px solid rgba(117, 121, 126, 0.349);
            border-radius: 3px;
        }

        [role="tabpanel"] {
            padding: 5px;
            border: 1px solid hsl(220deg 20% 94%);
            border-radius: 0 5px 5px;
            background: rgb(33 37 41);
            min-height: 10em;
            min-width: 250px;
            overflow: auto;
            font-size: small;
            overflow-y: auto;
            max-height: 90vh;
        }

        [role="tabpanel"].is-hidden {
            display: none;
            overflow: auto;
            overflow-y: auto;
            scroll-behavior: auto;
        }

        [role="tabpanel"] p {
            margin: 0;
            overflow: auto;
        }

        .profile-container {
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            text-align: center;
            color: #fff
        }

        .resizable-left {
            padding: 30px;
            /* background: rgba(0,0,0,0.2); */

            text-align: center;
            color: #fff;
            height: 100vh;
            overflow: auto;
        }

        .resizable-left::-webkit-scrollbar {
            display: none;
            /* Safari and Chrome */
        }

        .resizable-right {
            padding: 30px;
            /* background: rgba(0,0,0,0.2); */

            text-align: start;
            background-color: #fff;
            height: 100vh;
            overflow: auto;
        }

        .resizable-right::-webkit-scrollbar {
            display: none;
            /* Safari and Chrome */
        }

        .nav-item :hover {
            background: rgba(0, 0, 0, 0.2);

        }

        .profile-container .tagline {
            color: rgba(255, 255, 255, 0.6);
            font-size: 16px;
            font-weight: 300;
            margin-top: 0;
            margin-bottom: 0
        }

        .education-container .item {
            margin-bottom: 15px
        }

        .education-container .item:last-child {
            margin-bottom: 0
        }

        .education-container .meta {
            color: rgba(255, 255, 255, 0.6);
            font-weight: 400;
            margin-bottom: 0px;
            margin-top: 0
        }

        .education-container .time {
            color: rgba(255, 255, 255, 0.6);
            font-weight: 400;
            margin-bottom: 0px
        }

        .languages-container .lang-desc {
            color: rgba(255, 255, 255, 0.6)
        }

        .languages-list {
            margin-bottom: 0
        }

        .languages-list li {
            margin-bottom: 10px
        }

        .languages-list li:last-child {
            margin-bottom: 0
        }

        .project-title {
            font-size: 16px;
            font-weight: 400;
            margin-top: 0;
            margin-bottom: 5px;
            color: #2d7788
        }

        .projects-section .intro {
            margin-bottom: 30px
        }

        .projects-section .item {
            margin-bottom: 15px
        }

        .section-title {
            text-transform: uppercase;
            font-size: 20px;
            font-weight: 500;
            color: #2d7788;
            position: relative;
            margin-top: 0;
            margin-bottom: 0px
        }
    </style>


</head>

<body>
    <div id="main" style="max-height: 100vh; overflow-y: auto; overflow-x: hidden;">
        <div class="resizable-left" id="win1" style="max-height: 100vh; overflow: scroll; overflow-y: scroll;">
            <div class="d-flex flex-column flex-shrink-0 p-3 text-white "
                style="display: flex; min-width: 200px; background: #35869A; ">

                <div class="profile-container" style="border-radius: 10px 10px 10px 10px; ">
                    <img class="avatar" src="./img/Resim1.png" alt="profile picture"
                        style="background-position:center; border-radius: 50px 50px 50px 50px; ">
                    <h1 class="name">Ali AKGÖZ</h1>
                    <h5 class="tagline">Developer / Data Scientist</h5>
                </div>
                <hr>
                <ul class="nav nav-pills flex-column mb-auto " style="text-align: start;">
                    <li class="nav-item">
                        <a href="mailto:aliakgoz@gmail.com" class="nav-link text-white ">
                            <i class="fa-solid fa-at"></i>
                            <sub> aliakgoz@gmail.com</sub>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="https://github.com/aliakgoz" class="nav-link text-white">
                            <i class="fa-brands fa-github"></i>
                            <sub> github.com/aliakgoz</sub>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="https://www.linkedin.com/in/ali-akg%C3%B6z-53370619b/" class="nav-link text-white">
                            <i class="fa-brands fa-linkedin"></i>
                            <sub> linkedin.com/in/ali-akgöz-53370619b</sub>
                        </a>
                    </li>



                    <li class="nav-item">
                        <a href="./myfiles/ALI_AKGOZ_CV_v0.3.pdf" class="nav-link text-white">
                            <i class="fa-solid fa-file-pdf"></i>
                            <sub> PDF Resume</sub>
                        </a>
                    </li>

                </ul>

                <hr>

                <div class="education-container container-block" style="text-align: start;">
                    <h4 class="container-block-title">
                        Education
                    </h4>
                    <div class="item">
                        <h5 class="degree">MSc in Civil Engineering</h5>
                        <h6 class="meta">Hacettepe University</h6>
                        <div class="time">2021 - 2023</div>
                    </div>
                    <div class="item">
                        <h5 class="degree">BSc in Civil Engineering</h5>
                        <h6 class="meta">Middle East Technical University</h6>
                        <div class="time">2006 - 2011</div>
                    </div>
                </div>

                <hr>

                <div class="languages-container container-block" style="text-align: start;">
                    <h4 class="container-block-title">
                        Languages
                    </h4>
                    <ul class="list-unstyled interests-list">
                        <li>
                            Turkish
                            <span class="lang-desc">(Native)</span>
                        </li>
                        <li>
                            English
                            <span class="lang-desc">(Professional)</span>
                        </li>

                    </ul>
                </div>
                <div class="tabs">

                    <div role="tablist" aria-labelledby="tablist-1" class="automatic">
                        <button id="tab-1" type="button" role="tab" aria-selected="true" aria-controls="tabpanel-1">
                            <span class="focus">
                                Veri
                            </span>
                        </button>
                        <button id="tab-2" type="button" role="tab" aria-selected="false" aria-controls="tabpanel-2"
                            tabindex="-1">
                            <span class="focus">
                                Analiz
                            </span>
                        </button>
                        <button id="tab-3" type="button" role="tab" aria-selected="false" aria-controls="tabpanel-3"
                            tabindex="-1">
                            <span class="focus">
                                Ayarlar
                            </span>
                        </button>
                        <!-- <button id="tab-4" type="button" role="tab" aria-selected="false" aria-controls="tabpanel-4"
                            tabindex="-1">
                            <span class="focus">
                                Peter Lange-Müller
                            </span>
                        </button> -->
                    </div>
                    <div id="tabpanel-1" role="tabpanel" tabindex="0" aria-labelledby="tab-1">
                        <div class="text-center">
                            <img class="center-block" src="./img/Resim1.png"
                                style="background-color:  rgb(33 37 41); border: 0px; height: 80px;">

                        </div>
                        <a href="/"
                            class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                            <!-- <svg class="bi me-2" width="40" height="24">
                                <use xlink:href="#bootstrap"></use>
                            </svg> -->


                            <h3><a style="display: flex; justify-content: center; ">TENMAK NÜKEN</a></h3>



                            <p style="display: flex; justify-content: center"><u>İHA Veri Analiz ve Haritalama
                                    Sistemi</u></p>



                        </a>
                        <hr>
                        <p style="padding: 4px;">Veri Bağlantısı</p>
                        <!-- <hr> -->
                        <div class="row g-3">
                            <div class="col">
                                <a style="display: flex; justify-content: center; padding: 4px;"
                                    id="coordlatlng">LatLng(Lat,Long)</a>
                            </div>

                        </div>
                        <div class="row g-3">
                            <div class="col-sm-5">
                                <div class="input-group mb-3">
                                    <label class="input-group-text" for="baudrate_options"
                                        style="font-size: 12px;">BAUD</label>
                                    <select class="form-select" id="baudrate_options" style="font-size: 12px;">
                                        <option value="57600" selected>57600</option>
                                        <option value="9600">9600</option>
                                        <option value="14400">14400</option>
                                        <option value="19200">19200</option>
                                        <option value="38400">38400</option>
                                        <option value="74880">74880</option>
                                        <option value="115200">115200</option>
                                        <!-- <option value="8">Hot</option>
                                        <option value="9">Hot</option>
                                        <option value="10">Hot</option>
                                        <option value="11">Hot</option> -->

                                        <!-- <option value="2">Hot</option> -->
                                        <!-- <option value="3">Three</option> -->
                                    </select>
                                </div>

                            </div>
                            <div class="col-sm">
                                <!-- <input type="text" class="form-control" placeholder="State" aria-label="State"> -->
                            </div>
                            <div class="col-sm">
                                <button type="button" class="btn btn-secondary" id="connectbutton"
                                    style="width: 100px; font-size: small; padding: 4px;">
                                    Bağlan
                                </button>
                            </div>
                        </div>


                        <div class="mb-3">
                            <label for="gelenveriTextarea1" class="form-label">Gelen Veri</label>
                            <textarea class="form-control" id="gelenveriTextarea1" rows="10"
                                style="font-size: 12px; margin-bottom: 4px;"></textarea>
                            <!-- <button type="button" class="btn btn-secondary" id="butOpenFile"
                                style="width: 100px; font-size: small; padding: 4px;">
                                Dosya Aç
                            </button> -->
                            <div class="row g-3">
                                <div class="col-sm-5">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" role="switch"
                                            id="autoscrollCheck" checked>
                                        <label class="form-check-label" for="autoscrollCheck">Otomatik Kaydır</label>
                                    </div>
                                </div>
                                <div class="col-sm">

                                    <button type="button" class="btn btn-secondary" id="logacbutton"
                                        style="width: 100px; font-size: small; padding: 4px;">
                                        Log aç
                                    </button>

                                </div>
                                <div class="col-sm">
                                    <button type="button" class="btn btn-secondary" id="logkaydetbutton"
                                        style="width: 100px; font-size: small; padding: 4px;">
                                        Log Kaydet
                                    </button>

                                </div>



                            </div>

                            <hr>


                            <!-- <abbr title="United States Dollars">
                                  USD
                                </abbr> -->
                            <!-- 
                            <label id="combo1-label" class="combo-label">
                                Select Colormap
                            </label>
                            <div class="combo js-select">
                                <div aria-controls="listbox1" aria-expanded="false" aria-haspopup="listbox"
                                    aria-labelledby="combo1-label" id="combo1" class="combo-input" role="combobox"
                                    tabindex="0">
                                </div>
                                <div class="combo-menu" role="listbox" id="listbox1" aria-labelledby="combo1-label"
                                    tabindex="-1">
                                </div>
                            </div> -->

                            <div class="row g-3">
                                <div class="col-sm">
                                    <label for="carpanRange" id="carpanRangeLabel" class="form-label">L - P</label>
                                    <input type="range" class="form-range" min="1" max="99" id="carpanRange">
                                </div>
                                <div class="col-sm">
                                    <label class="form-label">Dedektör</label>
                                    <div class="input-group mb-3">
                                        <label class="input-group-text" for="markersetselect"
                                            style="font-size: 12px;">Seçiniz</label>
                                        <select class="form-select" id="markersetselect" style="font-size: 12px;">
                                            <option value="toplam" selected>Toplam</option>
                                            <option value="carpim">Çarpım</option>
                                            <option value="expcarpim">Expçarpım</option>
                                            <option value="lantan">Lantan</option>
                                            <option value="plastik">Plastik</option>
                                        </select>
                                    </div>

                                </div>
                                <div class="col-sm">
                                    <!-- <label for="expcarpimRange" id="expcarpimLabel" class="form-label">Çarpım
                                        Katsayı</label>
                                    <input type="range" class="form-range" min="33" max="99" id="expcarpimRange" value="33"> -->
                                </div>
                            </div>
                            <hr>


                            <div class="row g-3">
                                <div class="col-sm-5">
                                    <label class="form-label">Renk Haritası</label>
                                    <div class="input-group mb-3">
                                        <label class="input-group-text" for="colormapselect"
                                            style="font-size: 12px;">Seçiniz</label>
                                        <select class="form-select" id="colormapselect" style="font-size: 12px;">
                                            <option value="RdYlBu">RdYlBu</option>
                                            <option value="hot" selected>Hot</option>
                                            <option value="viridis">viridis</option>
                                            <option value="gist_heat">gist_heat</option>
                                            <option value="Accent">Accent</option>
                                            <option value="Blues">Blues</option>
                                            <option value="BrBG">BrBG</option>
                                            <option value="BuGn">BuGn</option>
                                            <option value="BuPu">BuPu</option>
                                            <option value="CMRmap">CMRmap</option>
                                            <option value="Dark2">Dark2</option>
                                            <option value="GnBu">GnBu</option>
                                            <option value="Greens">Greens</option>
                                            <option value="Greys">Greys</option>
                                            <option value="OrRd">OrRd</option>
                                            <option value="Oranges">Oranges</option>
                                            <option value="PRGn">PRGn</option>
                                            <option value="Paired">Paired</option>
                                            <option value="Pastel1">Pastel1</option>
                                            <option value="Pastel2">Pastel2</option>
                                            <option value="PiYG">PiYG</option>
                                            <option value="PuBu">PuBu</option>
                                            <option value="PuBuGn">PuBuGn</option>
                                            <option value="PuOr">PuOr</option>
                                            <option value="PuRd">PuRd</option>
                                            <option value="Purples">Purples</option>
                                            <option value="RdBu">RdBu</option>
                                            <option value="RdGy">RdGy</option>
                                            <option value="RdPu">RdPu</option>
                                            <option value="RdYlGn">RdYlGn</option>
                                            <option value="Reds">Reds</option>
                                            <option value="Set1">Set1</option>
                                            <option value="Set2">Set2</option>
                                            <option value="Set3">Set3</option>
                                            <option value="Spectral">Spectral</option>
                                            <option value="Wistia">Wistia</option>
                                            <option value="YlGn">YlGn</option>
                                            <option value="YlGnBu">YlGnBu</option>
                                            <option value="YlOrBr">YlOrBr</option>
                                            <option value="YlOrRd">YlOrRd</option>
                                            <option value="afmhot">afmhot</option>
                                            <option value="autumn">autumn</option>
                                            <option value="binary">binary</option>
                                            <option value="bone">bone</option>
                                            <option value="brg">brg</option>
                                            <option value="bwr">bwr</option>
                                            <option value="cividis">cividis</option>
                                            <option value="cool">cool</option>
                                            <option value="coolwarm">coolwarm</option>
                                            <option value="copper">copper</option>
                                            <option value="cubehelix">cubehelix</option>
                                            <option value="flag">flag</option>
                                            <option value="gist_earth">gist_earth</option>
                                            <option value="gist_gray">gist_gray</option>
                                            <option value="gist_ncar">gist_ncar</option>
                                            <option value="gist_rainbow">gist_rainbow</option>
                                            <option value="gist_stern">gist_stern</option>
                                            <option value="gist_yarg">gist_yarg</option>
                                            <option value="gnuplot">gnuplot</option>
                                            <option value="gnuplot2">gnuplot2</option>
                                            <option value="gray">gray</option>
                                            <option value="hsv">hsv</option>
                                            <option value="inferno">inferno</option>
                                            <option value="jet">jet</option>
                                            <option value="magma">magma</option>
                                            <option value="nipy_spectral">nipy_spectral</option>
                                            <option value="ocean">ocean</option>
                                            <option value="pink">pink</option>
                                            <option value="plasma">plasma</option>
                                            <option value="prism">prism</option>
                                            <option value="rainbow">rainbow</option>
                                            <option value="seismic">seismic</option>
                                            <option value="spring">spring</option>
                                            <option value="summer">summer</option>
                                            <option value="tab10">tab10</option>
                                            <option value="tab20">tab20</option>
                                            <option value="tab20b">tab20b</option>
                                            <option value="tab20c">tab20c</option>
                                            <option value="terrain">terrain</option>
                                            <option value="turbo">turbo</option>
                                            <option value="twilight">twilight</option>
                                            <option value="twilight_shifted">twilight_shifted</option>
                                            <option value="winter">winter</option>

                                            <!-- <option value="2">Hot</option> -->
                                            <!-- <option value="3">Three</option> -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm">

                                    <!-- <div class="slider-multithumb">
                                <svg role="none" class="slider-group" width="360" height="60">
                                    <g aria-hidden="true" class="rail">
                                        <rect height="0" width="0"></rect>
                                    </g>
                                    <g aria-hidden="true" class="range">
                                        <rect height="0" width="0"></rect>
                                    </g>
                                    <g class="minimum" role="slider" tabindex="0" aria-valuemin="0" aria-valuenow="100"
                                        aria-valuemax="250" aria-label="Hotel Minimum Price in US dollars">
                                        <text class="value">
                                            0
                                        </text>
                                        <rect class="focus-ring" height="0" width="0"></rect>
                                        <polygon class="thumb" points="0,0 0,0"></polygon>
                                    </g>
                                    <g class="maximum" role="slider" tabindex="0" aria-valuemin="100"
                                        aria-valuenow="250" aria-valuemax="400"
                                        aria-label="Hotel Maximum Price in US dollars">
                                        <text class="value">
                                            0
                                        </text>
                                        <rect class="focus-ring" height="0" width="0"></rect>
                                        <polygon class="thumb" points="0,0 0,0"></polygon>
                                    </g>
                                </svg>
                            </div> -->
                                    <label for="colormapRange" class="form-label">Renk Haritası Aralığı</label>
                                    <input type="range" class="form-range" min="0" max="255" id="colormapRange">
                                </div>
                                <div class="col-sm">
                                    <!-- <input type="text" class="form-control" placeholder="Zip" aria-label="Zip"> -->
                                    <label for="opacityRange" class="form-label">Opaklık</label>
                                    <input type="range" class="form-range" min="0" max="100" id="opacityRange"
                                        value="100">
                                </div>
                            </div>
                            <hr>
                            <!-- <button type="button" class="btn btn-secondary" id="soundbutton"
                                style="width: 100px; font-size: small; padding: 4px;">
                                Sound
                            </button> -->


                        </div>

                    </div>
                    <div id="tabpanel-2" role="tabpanel" tabindex="0" aria-labelledby="tab-2" class="is-hidden">


                        <button type="button" class="btn btn-secondary" id="butOpenCsv"
                            style="width: 100px; font-size: small; padding: 4px; margin-bottom: 6px;">
                            Csv Aç
                        </button>
                        <!-- <table class="myCsvTable"></table> -->
                        <table class="table table-dark table-striped table-hover" id="myCsvTable">

                        </table>

                        <div id='myHistogram1'>
                            <!-- Plotly chart will be drawn inside this DIV -->
                        </div>

                        <button type="button" class="btn btn-secondary" id="lfdatamap"
                            style="width: 100px; font-size: small; padding: 4px;">
                            Lf data plot
                        </button>

                        <div id='my3Dplot'>
                            <!-- Plotly chart will be drawn inside this DIV -->
                        </div>

                        <button type="button" class="btn btn-secondary" id="3Dplotbutton"
                            style="width: 100px; font-size: small; padding: 4px;">
                            3D plot
                        </button>

                        <button type="button" class="btn btn-secondary" id="hexbinbutton"
                            style="width: 100px; font-size: small; padding: 4px;">
                            Hexbin Plot (D3)
                        </button>
                        <div class="options">
                            <label>Radius </label><input type="range" id="radius" value="25" min="10" max="50"><br>
                            <label>Blur </label><input type="range" id="blur" value="15" min="10" max="50">
                        </div>

                        <!-- Create a div where the graph will take place -->
                        <div id="my_dataviz"></div>




                    </div>
                    <div id="tabpanel-3" role="tabpanel" tabindex="0" aria-labelledby="tab-3" class="is-hidden">
                        <p>

                        </p>
                    </div>
                    <!-- <div id="tabpanel-4" role="tabpanel" tabindex="0" aria-labelledby="tab-4" class="is-hidden">
                        <p>
                            
                        </p>
                    </div> -->
                </div>


            </div>

        </div>
        <div class="resizable-right" id="win2">

            <section class="section projects-section">
                <h2 class="section-title">
                    Radiation Detector Project & Radioactivity Monitoring from UAV Project (2019 - ...)
                </h2>
                <sub>Turkish Energy, Nuclear and Mineral Research Agency - Nuclear Energy Research Institute</sub>
                <div class="intro">
                    <p>Currently, in a R&D team, I am working as a developer / data scientist / data visualization
                        expert in
                        government funded projects of developing a in-house Hand-held Radiation Detector and
                        Radioactivity Monitoring using UAV.

                    </p>
                </div>
                <div class="item">
                    <span class="project-title">
                        <a href="#hook" target="_blank">Velocity</a>
                    </span>
                    - <span class="project-tagline">A responsive website template designed to help startups promote,
                        market and sell their products.</span>
                </div>
                <div class="item">
                    <span class="project-title">
                        <a href="#" target="_blank">DevStudio</a>
                    </span>
                    - <span class="project-tagline">A responsive website template designed to help web
                        developers/designers market their services.</span>
                </div>
                <div class="item">
                    <span class="project-title">
                        <a href="#" target="_blank">Tempo</a>
                    </span>
                    - <span class="project-tagline">A responsive website template designed to help startups promote
                        their products or services and to attract users &amp; investors</span>
                </div>
                <div class="item">
                    <span class="project-title">
                        <a href="#" target="_blank">Atom</a>
                    </span>
                    - <span class="project-tagline">A comprehensive website template solution for startups/developers to
                        market their mobile apps.</span>
                </div>
                <div class="item">
                    <span class="project-title">
                        <a href="#" target="_blank">Delta</a>
                    </span>
                    - <span class="project-tagline">A responsive Bootstrap one page theme designed to help app
                        developers promote their mobile apps</span>
                </div>
            </section>

            <div class="online_3d_viewer" style="width: 800px; height: 600px;" model="./models/tenmak3_son_v1.obj">
            </div>

            <div class="folium-map" id="map_16d19f0c4cb02d0360d2d91f78fb101a">
            </div>


        </div>
    </div>




</body>
<script>
    /*
     *   This content is licensed according to the W3C Software License at
     *   https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document
     *
     *   File:   tabs-automatic.js
     *
     *   Desc:   Tablist widget that implements ARIA Authoring Practices
     */

    'use strict';


    

    class TabsAutomatic {
        constructor(groupNode) {
            this.tablistNode = groupNode;

            this.tabs = [];

            this.firstTab = null;
            this.lastTab = null;

            this.tabs = Array.from(this.tablistNode.querySelectorAll('[role=tab]'));
            this.tabpanels = [];

            for (var i = 0; i < this.tabs.length; i += 1) {
                var tab = this.tabs[i];
                var tabpanel = document.getElementById(tab.getAttribute('aria-controls'));

                tab.tabIndex = -1;
                tab.setAttribute('aria-selected', 'false');
                this.tabpanels.push(tabpanel);

                tab.addEventListener('keydown', this.onKeydown.bind(this));
                tab.addEventListener('click', this.onClick.bind(this));

                if (!this.firstTab) {
                    this.firstTab = tab;
                }
                this.lastTab = tab;
            }

            this.setSelectedTab(this.firstTab, false);
        }

        setSelectedTab(currentTab, setFocus) {
            if (typeof setFocus !== 'boolean') {
                setFocus = true;
            }
            for (var i = 0; i < this.tabs.length; i += 1) {
                var tab = this.tabs[i];
                if (currentTab === tab) {
                    tab.setAttribute('aria-selected', 'true');
                    tab.removeAttribute('tabindex');
                    this.tabpanels[i].classList.remove('is-hidden');
                    if (setFocus) {
                        tab.focus();
                    }
                } else {
                    tab.setAttribute('aria-selected', 'false');
                    tab.tabIndex = -1;
                    this.tabpanels[i].classList.add('is-hidden');
                }
            }
        }

        setSelectedToPreviousTab(currentTab) {
            var index;

            if (currentTab === this.firstTab) {
                this.setSelectedTab(this.lastTab);
            } else {
                index = this.tabs.indexOf(currentTab);
                this.setSelectedTab(this.tabs[index - 1]);
            }
        }

        setSelectedToNextTab(currentTab) {
            var index;

            if (currentTab === this.lastTab) {
                this.setSelectedTab(this.firstTab);
            } else {
                index = this.tabs.indexOf(currentTab);
                this.setSelectedTab(this.tabs[index + 1]);
            }
        }

        /* EVENT HANDLERS */

        onKeydown(event) {
            var tgt = event.currentTarget,
                flag = false;

            switch (event.key) {
                case 'ArrowLeft':
                    this.setSelectedToPreviousTab(tgt);
                    flag = true;
                    break;

                case 'ArrowRight':
                    this.setSelectedToNextTab(tgt);
                    flag = true;
                    break;

                case 'Home':
                    this.setSelectedTab(this.firstTab);
                    flag = true;
                    break;

                case 'End':
                    this.setSelectedTab(this.lastTab);
                    flag = true;
                    break;

                default:
                    break;
            }

            if (flag) {
                event.stopPropagation();
                event.preventDefault();
            }
        }

        onClick(event) {
            this.setSelectedTab(event.currentTarget);
        }
    }

    // Initialize tablist

    window.addEventListener('load', function () {
        var tablists = document.querySelectorAll('[role=tablist].automatic');
        for (var i = 0; i < tablists.length; i++) {
            new TabsAutomatic(tablists[i]);
        }
    });

    document.addEventListener("DOMContentLoaded", () => {
        //...
        document.getElementById("main").style.width = window.innerWidth + "px";
        document.getElementById("main").style.height = window.innerHeight + "px";
        document.getElementById("win1").style.height = "100 vh";
        document.getElementById("win1").style.maxHeight = "100 vh";

        var sizes = {
            "win1": 0.25,
            "win3": 0.75,
            "win4": 0.5,
            "win6": 0.4,
            "win11": 0.8,
            "win9": 0.5,
            "win13": 0.4
        };

        Resizable.initialise("main", sizes);
        // Resizable.initialise("main", {});

    });

    window.addEventListener("resize", () => {
        Resizable.activeContentWindows[0].changeSize(window.innerWidth, window.innerHeight);
        Resizable.activeContentWindows[0].childrenResize();
    });




    var myColormap = partial(document.getElementById('colormapselect').value);

    var map_16d19f0c4cb02d0360d2d91f78fb101a = L.map(
        "map_16d19f0c4cb02d0360d2d91f78fb101a", {
            center: [40.059774, 32.60246],
            crs: L.CRS.EPSG3857,
            zoom: 18,
            zoomControl: true,
            preferCanvas: false,
        }
    );


    class LineBreakTransformer {
        constructor() {
            // A container for holding stream data until a new line.
            this.chunks = "";
        }

        transform(chunk, controller) {
            // Append new chunks to existing chunks.
            this.chunks += chunk;
            // For each line breaks in chunks, send the parsed lines out.
            const lines = this.chunks.split("\r\n");
            this.chunks = lines.pop();
            lines.forEach((line) => controller.enqueue(line));
        }

        flush(controller) {
            // When the stream is closed, flush any remaining chunks out.
            controller.enqueue(this.chunks);
        }
    }
    // const url = 'http://127.0.0.1:3000/';
    $(document).ready(function () {

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar').toggleClass('active');
        });

    });

    var mymarkers = [];
    var xycount = [];
    var gelenveri = "";
    var carpan = 0.5;
    var myexp = 2;
    var max_count = {
        value: 1,
        set: function (value) {
            this.value = value;
            this.getOnChange();
        }
    };

    var max_lantan_count = {
        value: 1,
        set: function (value) {
            this.value = value;
            this.getOnChange();
        }
    };
    var max_plastik_count = {
        value: 1,
        set: function (value) {
            this.value = value;
            this.getOnChange();
        }
    };
    var max_carpim_count = {
        value: 1,
        set: function (value) {
            this.value = value;
            this.getOnChange();
        }
    };
    var max_expcarpim_count = {
        value: 1,
        set: function (value) {
            this.value = value;
            this.getOnChange();
        }
    };
    var cm_max_expcarpim_count = 1.0;




    var markerGroup = L.layerGroup().addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);



    // Filter on devices with the Arduino Uno USB Vendor/Product IDs.
    document.getElementById('connectbutton').addEventListener('click', async () => {
        // Prompt user to select any serial port.


        // const writable = await fileHandle.createWritable();
        let alltext = "";
        let lantan_geldi = false;
        let plastik_geldi = false;
        let lantan_count = 0;
        let plastik_count = 0;
        let lastlat = 40.05;
        let lastlon = 32.60;
        let total_count = 5.0;
        let ilksefer = true;
        let baudrate_options = document.getElementById('baudrate_options');
        let mybaudrate = baudrate_options.options[baudrate_options.selectedIndex].value;
        // console.log(mybaudrate);
        const port = await navigator.serial.requestPort();
        await port.open({
            baudRate: parseInt(mybaudrate),
            bufferSize: 10000000,
        });
        while (port.readable) {

            try {
                const textDecoder = new TextDecoderStream();
                const readableStreamClosed = port.readable.pipeTo(textDecoder.writable);

                const reader = textDecoder.readable
                    .pipeThrough(new TransformStream(new LineBreakTransformer()))
                    .getReader();


                // Listen to data coming from the serial device.
                while (true) {

                    const {
                        value,
                        done
                    } = await reader.read();
                    if (done) {
                        // Allow the serial port to be closed later.
                        reader.releaseLock();
                        break;
                    }
                    if ((value.slice(0, 2) == 'g ' && value.split(" ").length == 13) || (value.slice(0,
                            2) == 'p ' && value.split(" ").length == 4) || (value.slice(0, 2) == 'l ' &&
                            value.split(" ").length == 4)) {

                        // if (alltext == "") {
                        //     alltext = document.getElementById("gelenveriTextarea1").innerHTML;
                        // };
                        // alltext = alltext + new Date().toLocaleTimeString() + "." + new Date()
                        //     .getMilliseconds() + " " + value.toString() + "\n";
                        // await writeFile(fileHandle, alltext);

                        if (document.getElementById('autoscrollCheck').checked) {
                            document.getElementById("gelenveriTextarea1").scrollTop = document
                                .getElementById("gelenveriTextarea1").scrollHeight;
                        };

                        document.getElementById("gelenveriTextarea1").innerHTML = document
                            .getElementById("gelenveriTextarea1").innerHTML + new Date()
                            .toLocaleTimeString() + "." + new Date().getMilliseconds() + " " + value
                            .toString() + "\n";

                        gelenveri = gelenveri + new Date().toLocaleTimeString() + "." + new Date()
                            .getMilliseconds() + " " + value + "\n";

                        // ÖRNEK lantan , plastik ve gps datası
                        //p 205819 206660 296
                        //g 205853 iTOW: 206700 lat/lon: 0.000000 0.000000 height: 0 hAcc: 4294967 vAcc: 3750002
                        //l 205870 206700 11

                        let cihaz = value.split(" ")[0];
                        if (cihaz == "g") {
                            if (((1 - Math.abs(lastlat / parseFloat(value.split(" ")[5]))) > 0.1) ||
                                ilksefer) {
                                map_16d19f0c4cb02d0360d2d91f78fb101a.panTo(new L.LatLng(parseFloat(value
                                    .split(" ")[5]), parseFloat(value.split(" ")[6])));
                                ilksefer = false;
                            }
                            lastlat = parseFloat(value.split(" ")[5]);
                            lastlon = parseFloat(value.split(" ")[6]);

                        } else if (cihaz == "l") {
                            lantan_count = parseFloat(value.split(" ")[3]);
                            lantan_geldi = true;
                        } else if (cihaz == "p") {
                            plastik_count = parseFloat(value.split(" ")[3]);
                            plastik_geldi = true;
                        };

                        if (lantan_geldi && plastik_geldi) {

                            total_count = carpan * (lantan_count * 2) + (1 - carpan) * (
                                plastik_count * 2);
                            if (lastlat > 0.1) {
                                xycount.push([lastlat, lastlon, total_count]);
                            }

                            let carpim_count = Math.max(lantan_count, 1.0) * plastik_count;
                            let expcarpim_count = (Math.max(lantan_count, 1.0) ** myexp) * (plastik_count **
                                myexp);

                            let obj = {};

                            if (total_count > max_count.value) {
                                max_count.set(total_count);
                            };
                            if (carpim_count > max_carpim_count.value) {
                                max_carpim_count.set(carpim_count);
                            };
                            if (expcarpim_count > max_expcarpim_count.value) {
                                max_expcarpim_count.set(expcarpim_count);
                            };
                            if (lantan_count > max_lantan_count.value) {
                                max_lantan_count.set(lantan_count);
                            };
                            if (plastik_count > max_plastik_count.value) {
                                max_plastik_count.set(plastik_count);
                            };
                            let mymaxcount = 0;
                            let mycount = 0;
                            if (document.getElementById('markersetselect').value == "toplam") {
                                mymaxcount = max_count.value;
                                mycount = total_count;
                            } else if (document.getElementById('markersetselect').value == "carpim") {
                                mymaxcount = max_carpim_count.value;
                                mycount = carpim_count;
                            } else if (document.getElementById('markersetselect').value == "expcarpim") {
                                mymaxcount = max_expcarpim_count.value;
                                mycount = expcarpim_count;
                            } else if (document.getElementById('markersetselect').value == "lantan") {
                                mymaxcount = max_lantan_count.value;
                                mycount = lantan_count;
                            } else if (document.getElementById('markersetselect').value == "plastik") {
                                mymaxcount = max_plastik_count.value;
                                mycount = plastik_count;
                            };



                            let mypopup = "total: " + total_count.toString() + " l: " + lantan_count
                                .toString() + " p: " + plastik_count.toString();
                            lantan_geldi = false;
                            plastik_geldi = false;
                            obj['className'] = lantan_count.toString() + " " + plastik_count.toString();
                            lantan_count = 0;
                            plastik_count = 0;
                            // console.log(max_count.value);
                            obj['radius'] = '5';
                            obj['stroke'] = 'false';

                            obj['opacity'] = (document.getElementById('opacityRange').value / 100)
                                .toString();
                            obj['fillOpacity'] = (document.getElementById('opacityRange').value / 100)
                                .toString();
                            obj['color'] = 'rgb(' + myColormap(mycount / mymaxcount)[0] + ',' +
                                myColormap(mycount / mymaxcount)[1] + ',' + myColormap(
                                    mycount / mymaxcount)[2] + ')';
                            obj['weight'] = '0';


                            // L.circleMarker([parseFloat(value.split(",")[0].split("-")[0]), parseFloat(value.split(",")[0].split("-")[1])], { 'radius': '5', 'stroke': 'false', 'color': 'rgb(RdYlBu(parseFloat(value.split(",")[1])/101)[0],RdYlBu(parseFloat(value.split(",")[1])/101)[1],RdYlBu(parseFloat(value.split(",")[1])/101)[2])', 'weight': '0' }).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);
                            let mycirclemarker = L.circleMarker([lastlat, lastlon], obj).addTo(markerGroup);

                            mycirclemarker.bindPopup(mypopup);
                            mymarkers.push(mycirclemarker);


                            // console.log(mycirclemarker);
                        }

                        // console.log(mycirclemarker.options.className);

                    };




                };
            } catch (error) {
                document.getElementById("gelenveriTextarea1").innerHTML = document
                    .getElementById("gelenveriTextarea1").innerHTML + new Date()
                    .toLocaleTimeString() + "." + new Date().getMilliseconds() + " " + error.toString() +
                    "\n";
                gelenveri = gelenveri + new Date().toLocaleTimeString() + "." + new Date()
                    .getMilliseconds() + " " + error.toString() + "\n";
                // continue;
                // TODO: Handle non-fatal read error.
                continue;
            }

        };


    });



    document.getElementById('opacityRange').addEventListener('input', async () => {

        mymarkers.forEach(mymarker => {
            try {
                let obj = {};
                obj['opacity'] = (document.getElementById('opacityRange').value / 100).toString();
                obj['fillOpacity'] = (document.getElementById('opacityRange').value / 100)
                    .toString();
                mymarker.setStyle(obj);
            } catch (error) {
                console.log(error);
                return;
            }
        });

    });

    // document.getElementById('expcarpimRange').addEventListener('input', async () => {
    //     cm_max_expcarpim_count = cm_max_expcarpim_count ** (1 / myexp);
    //     myexp = event.target.value / 33;
    //     cm_max_expcarpim_count = cm_max_expcarpim_count ** (myexp);
    //     document.getElementById('expcarpimLabel').innerHTML = "Çarpım Katsayı: " + myexp.toString();
    //     // console.log(myexp);
    //     if (document.getElementById('markersetselect').value == "expcarpim") {
    //         console.log("buraya girdi");
    //         markerGroup.clearLayers();
    //         myColormap = partial(document.getElementById('colormapselect').value);
    //         markerGroup = L.layerGroup().addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);

    //         // var myexp = parseFloat(document.getElementById("expcarpimRange").value) / 33;
    //         mymarkers.forEach(mymarker => {
    //             try {

    //                 var obj = {};
    //                 var value = mymarker.options.className;
    //                 var cm_lantan_count = parseFloat(value.split(" ")[0]);
    //                 var cm_plastik_count = parseFloat(value.split(" ")[1]);
    //                 var cm_expcarpim_count = (Math.max(cm_lantan_count, 1.0) ** myexp) * (
    //                     cm_plastik_count ** myexp);
    //                 // console.log("myexp: " + myexp + " cm_expcarpim_count: " + cm_expcarpim_count + "max: " + max_expcarpim_count.value);
    //                 obj['color'] = 'rgb(' + myColormap(cm_expcarpim_count / cm_max_expcarpim_count)[0] + ',' +
    //                     myColormap(cm_expcarpim_count / cm_max_expcarpim_count)[1] + ',' +
    //                     myColormap(
    //                         cm_expcarpim_count / cm_max_expcarpim_count)[2] + ')';

    //                 mymarker.setStyle(obj);
    //                 mymarker.addTo(markerGroup);
    //             } catch (error) {
    //                 console.log(error);
    //                 return;
    //             }

    //         });
    //     }
    // });

    document.getElementById('carpanRange').addEventListener('input', async () => {
        carpan = parseFloat(document.getElementById('carpanRange').value) / 100;
        document.getElementById('carpanRangeLabel').innerHTML = "L - P (L: %" + document
            .getElementById('carpanRange').value + " P: %" + (100 - parseInt(document
                .getElementById('carpanRange').value)).toString() + ")";
        if (document.getElementById('markersetselect').value == "toplam") {
            try {

                mymarkers.forEach(mymarker => {
                    try {

                        let obj = {};
                        let value = mymarker.options.className;
                        let cm_lantan_count = parseFloat(value.split(" ")[0]);
                        let cm_plastik_count = parseFloat(value.split(" ")[1]);
                        let cm_total_count = (1 - carpan) * parseFloat(cm_lantan_count * 2) +
                            carpan * parseFloat(cm_plastik_count * 2);
                        let cm_max_total_count = (1 - carpan) * parseFloat(max_lantan_count.value *
                                2) +
                            carpan * parseFloat(max_plastik_count.value * 2);

                        obj['color'] = 'rgb(' + myColormap(cm_total_count / parseFloat(
                            cm_max_total_count))[0] + ',' + myColormap(cm_total_count /
                            parseFloat(cm_max_total_count))[1] + ',' + myColormap(
                            cm_total_count / parseFloat(cm_max_total_count))[2] + ')';

                        mymarker.setStyle(obj);
                        // mymarker.options.fillOpacity = document.getElementById('opacityRange').value/100;
                        // mymarker.redraw();
                    } catch (error) {
                        console.log("carpim foreach: " + error.toString());
                        return;
                    }
                });

            } catch (error) {
                console.log(error);
            };
        };

    });

    document.getElementById('colormapselect').addEventListener('change', async (event) => {
        myColormap = partial(event.target.value);

        mymarkers.forEach(mymarker => {
            try {
                let obj = {};
                let value = mymarker.options.className;
                let cm_lantan_count = parseFloat(value.split(" ")[0]);
                let cm_plastik_count = parseFloat(value.split(" ")[1]);
                let cm_total_count = carpan * (cm_lantan_count * 2) + (1 - carpan) * (
                    cm_plastik_count *
                    2);
                let cm_carpim_count = Math.max(cm_lantan_count, 1.0) * cm_plastik_count;
                let cm_expcarpim_count = (Math.max(cm_lantan_count, 1.0) ** myexp) * (
                    cm_plastik_count **
                    myexp);
                let markerset = document.getElementById('markersetselect').value;
                if (markerset == 'toplam') {
                    obj['color'] = 'rgb(' + myColormap(cm_total_count / max_count.value)[0] + ',' +
                        myColormap(cm_total_count / max_count.value)[1] + ',' + myColormap(
                            cm_total_count /
                            max_count.value)[2] + ')';
                } else if (markerset == 'carpim') {
                    obj['color'] = 'rgb(' + myColormap(cm_carpim_count / max_carpim_count.value)[
                            0] +
                        ',' + myColormap(cm_carpim_count / max_carpim_count.value)[1] + ',' +
                        myColormap(cm_carpim_count / max_carpim_count.value)[2] + ')';
                } else if (markerset == "expcarpim") {
                    obj['color'] = 'rgb(' + myColormap(cm_expcarpim_count / max_expcarpim_count
                            .value)[
                            0] + ',' +
                        myColormap(cm_expcarpim_count / max_expcarpim_count.value)[1] + ',' +
                        myColormap(
                            cm_expcarpim_count / max_expcarpim_count.value)[2] + ')';
                } else if (markerset == "lantan") {
                    obj['color'] = 'rgb(' + myColormap(cm_lantan_count / max_lantan_count.value)[
                            0] +
                        ',' +
                        myColormap(cm_lantan_count / max_lantan_count.value)[1] + ',' + myColormap(
                            cm_lantan_count /
                            max_lantan_count.value)[2] + ')';
                } else if (markerset == "plastik") {
                    obj['color'] = 'rgb(' + myColormap(cm_plastik_count / max_plastik_count.value)[
                            0] +
                        ',' +
                        myColormap(cm_plastik_count / max_plastik_count.value)[1] + ',' +
                        myColormap(
                            cm_plastik_count / max_plastik_count.value)[2] + ')';
                }
                mymarker.setStyle(obj);
            } catch (error) {
                console.log(error);
                return;
            }

        });

    });

    document.getElementById('markersetselect').addEventListener('change', async (event) => {
        myColormap = partial(document.getElementById('colormapselect').value);
        markerGroup.clearLayers();
        markerGroup = L.layerGroup().addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);
        // console.log("denemeeee");
        let markerset = event.target.value;

        // TOTAL
        if (markerset == "toplam") {

            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    let cm_total_count = carpan * (cm_lantan_count * 2) + (1 - carpan) * (
                        cm_plastik_count * 2);
                    obj['color'] = 'rgb(' + myColormap(cm_total_count / max_count.value)[0] + ',' +
                        myColormap(cm_total_count / max_count.value)[1] + ',' + myColormap(
                            cm_total_count / max_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                    mymarker.addTo(markerGroup);
                } catch (error) {
                    console.log(error);
                    return;
                }
            });
            //lantan
        } else if (markerset == "carpim") {
            // ÇARPIM            
            mymarkers.forEach(mymarker => {
                try {

                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    let cm_carpim_count = Math.max(cm_lantan_count, 1.0) * cm_plastik_count;

                    obj['color'] = 'rgb(' + myColormap(cm_carpim_count / max_carpim_count.value)[
                            0] +
                        ',' + myColormap(cm_carpim_count / max_carpim_count.value)[1] + ',' +
                        myColormap(cm_carpim_count / max_carpim_count.value)[2] + ')';

                    mymarker.setStyle(obj);

                    mymarker.addTo(markerGroup);

                } catch (error) {
                    console.log(error);
                    return;
                }
            });

        } else if (markerset == "expcarpim") {

            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    // console.log("lantan " + cm_lantan_count);
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    // console.log("plastik " + cm_plastik_count);
                    let cm_expcarpim_count = (Math.max(cm_lantan_count, 1.0) ** myexp) * (
                        cm_plastik_count ** myexp);
                    // console.log(cm_expcarpim_count);
                    obj['color'] = 'rgb(' + myColormap(cm_expcarpim_count / max_expcarpim_count
                            .value)[
                            0] + ',' +
                        myColormap(cm_expcarpim_count / max_expcarpim_count.value)[1] + ',' +
                        myColormap(
                            cm_expcarpim_count / max_expcarpim_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                    mymarker.addTo(markerGroup);
                } catch (error) {
                    console.log(error);
                    return;
                }
            });
        } else if (markerset == "lantan") {

            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    obj['color'] = 'rgb(' + myColormap(cm_lantan_count / max_lantan_count.value)[
                            0] +
                        ',' +
                        myColormap(cm_lantan_count / max_lantan_count.value)[1] + ',' + myColormap(
                            cm_lantan_count /
                            max_lantan_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                    mymarker.addTo(markerGroup);
                } catch (error) {
                    console.log(error);
                    return;
                }
            });

        } else if (markerset == "plastik") {

            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    obj['color'] = 'rgb(' + myColormap(cm_plastik_count / max_plastik_count.value)[
                            0] +
                        ',' +
                        myColormap(cm_plastik_count / max_plastik_count.value)[1] + ',' +
                        myColormap(
                            cm_plastik_count / max_plastik_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                    mymarker.addTo(markerGroup);
                } catch (error) {
                    console.log(error);
                    return;
                }
            });

        };

    });

    max_count.getOnChange = function () {
        // console.log("total max:" + max_count.value.toString());
        if (document.getElementById('markersetselect').value == "toplam") {
            console.log("max_count   ###########################################################" + max_count.value
                .toString());
            myColormap = partial(document.getElementById('colormapselect').value);

            mymarkers.forEach(mymarker => {
                try {

                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    let cm_total_count = carpan * (cm_lantan_count * 2) + (1 - carpan) * (cm_plastik_count *
                        2);


                    obj['color'] = 'rgb(' + myColormap(cm_total_count / max_count.value)[0] + ',' +
                        myColormap(cm_total_count / max_count.value)[1] + ',' + myColormap(cm_total_count /
                            max_count.value)[2] + ')';


                    mymarker.setStyle(obj);


                } catch (error) {
                    console.log(error);
                    return;
                }
            });
        }


    };

    max_lantan_count.getOnChange = function () {
        if (document.getElementById('markersetselect').value == "lantan") {
            console.log("max_lantan_count   ###########################################################" +
                max_lantan_count.value.toString());
            // console.log("lantan max: " + max_lantan_count.value.toString());
            myColormap = partial(document.getElementById('colormapselect').value);
            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    obj['color'] = 'rgb(' + myColormap(cm_lantan_count / max_lantan_count.value)[0] + ',' +
                        myColormap(cm_lantan_count / max_lantan_count.value)[1] + ',' + myColormap(
                            cm_lantan_count /
                            max_lantan_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                } catch (error) {
                    console.log(error);
                    return;
                }

            });
        }


    };

    max_plastik_count.getOnChange = function () {
        if (document.getElementById('markersetselect').value == "plastik") {
            console.log("max_plastik_count   ###########################################################" +
                max_plastik_count.value.toString());
            // console.log("plastik max: " + max_plastik_count.value.toString());
            myColormap = partial(document.getElementById('colormapselect').value);
            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    obj['color'] = 'rgb(' + myColormap(cm_plastik_count / max_plastik_count.value)[0] +
                        ',' +
                        myColormap(cm_plastik_count / max_plastik_count.value)[1] + ',' + myColormap(
                            cm_plastik_count / max_plastik_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                } catch (error) {
                    console.log(error);
                    return;
                }

            });
        }


    };

    max_carpim_count.getOnChange = function () {
        if (document.getElementById('markersetselect').value == "carpim") {
            console.log("max_carpim_count   ###########################################################" +
                max_carpim_count.value.toString());
            // console.log("plastik max: " + max_plastik_count.value.toString());
            myColormap = partial(document.getElementById('colormapselect').value);
            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    let cm_carpim_count = Math.max(cm_lantan_count, 1.0) * cm_plastik_count;

                    obj['color'] = 'rgb(' + myColormap(cm_carpim_count / max_carpim_count.value)[0] + ',' +
                        myColormap(cm_carpim_count / max_carpim_count.value)[1] + ',' + myColormap(
                            cm_carpim_count /
                            max_carpim_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                } catch (error) {
                    console.log(error);
                    return;
                }

            });
        }


    };

    max_expcarpim_count.getOnChange = function () {
        if (document.getElementById('markersetselect').value == "expcarpim") {
            console.log("max_expcarpim_count   ###########################################################" +
                max_expcarpim_count.value.toString());
            // console.log("plastik max: " + max_plastik_count.value.toString());
            myColormap = partial(document.getElementById('colormapselect').value);
            mymarkers.forEach(mymarker => {
                try {
                    let obj = {};
                    let value = mymarker.options.className;
                    let cm_lantan_count = parseFloat(value.split(" ")[0]);
                    let cm_plastik_count = parseFloat(value.split(" ")[1]);
                    let cm_expcarpim_count = (Math.max(cm_lantan_count, 1.0) ** myexp) * (
                        cm_plastik_count **
                        myexp);

                    obj['color'] = 'rgb(' + myColormap(cm_expcarpim_count / max_expcarpim_count.value)[0] +
                        ',' +
                        myColormap(cm_expcarpim_count / max_expcarpim_count.value)[1] + ',' + myColormap(
                            cm_expcarpim_count / max_expcarpim_count.value)[2] + ')';

                    mymarker.setStyle(obj);
                } catch (error) {
                    console.log(error);
                    return;
                }

            });
        }

    };

    let fileHandle_csv;
    let mycsvarr;

    document.getElementById('butOpenCsv').addEventListener('click', async () => {

        [fileHandle_csv] = await window.showOpenFilePicker();
        const file = await fileHandle_csv.getFile();
        const contents = await file.text();
        mycsvarr = csvStringToArray(contents);
        console.log(mycsvarr);

        // // Find a <table> element with id="myCsvTable":
        let table = document.getElementById("myCsvTable");
        for (let i = 0; i < 6; i++) {
            let row = table.insertRow(i);
            let item = mycsvarr[i];
            item.forEach(function (item2, index2) {
                let cell1 = row.insertCell(index2);
                cell1.innerHTML = item2;
                console.log(item2);
            });

        }


        const arrayColumn = (arr, n) => arr.map(x => x[n]);


        let trace = {
            x: arrayColumn(mycsvarr, 5),
            type: 'histogram',
            // cumulative: { enabled: true }
        };
        let config = {
            responsive: true
        }
        let data = [trace];
        let layout = {
            title: 'Histogram',
            font: {
                size: 14
            }
        };
        Plotly.newPlot('myHistogram1', data, layout, config);


    });

    document.getElementById('3Dplotbutton').addEventListener('click', async () => {
        let x = [];
        let y = [];
        let z = [];
        let c = [];
        mymarkers.forEach(mymarker => {
            x.push(mymarker.getLatLng().lat);
            y.push(mymarker.getLatLng().lng);
            let value = mymarker.options.className;
            let cm_lantan_count = parseFloat(value.split(" ")[0]);
            let cm_plastik_count = parseFloat(value.split(" ")[1]);
            let cm_carpim_count = Math.max(cm_lantan_count, 1.0) * cm_plastik_count;
            z.push(cm_carpim_count / max_carpim_count.value);
            c.push(cm_carpim_count / max_carpim_count.value);
        });


        Plotly.newPlot('my3Dplot', [{
            type: 'scatter3d',
            mode: 'lines',
            x: x,
            y: y,
            z: z,
            opacity: 1,
            line: {
                width: 6,
                color: c,
                reversescale: false
            }
        }], {
            height: 640
        });


    });





    document.getElementById('lfdatamap').addEventListener('click', async () => {
        myColormap = partial(document.getElementById('colormapselect').value);
        const arrayColumn = (arr, n) => arr.map(x => x[n]);
        let latarr = arrayColumn(mycsvarr, 3);
        let lonarr = arrayColumn(mycsvarr, 4);
        let dosearr = arrayColumn(mycsvarr, 5);
        let floatdosearr = dosearr.slice(1, dosearr.length - 1).map(Number);
        console.log(floatdosearr);
        let maxdose = parseFloat(Math.max.apply(Math, floatdosearr));
        // parseFloat(item) / maxdose
        map_16d19f0c4cb02d0360d2d91f78fb101a.panTo(new L.LatLng(parseFloat(latarr[20]), parseFloat(lonarr[
            20])));
        floatdosearr.forEach(function (item, index) {
            try {
                if (index > 0) {
                    console.log(maxdose);
                    console.log(index);
                    console.log(item);
                    let obj = {};
                    obj['radius'] = '5';
                    obj['stroke'] = 'false';
                    obj['color'] = 'rgb(' + myColormap(parseFloat(item) / maxdose)[0] + ',' +
                        myColormap(
                            parseFloat(item) / maxdose)[1] + ',' + myColormap(parseFloat(item) /
                            maxdose)[2] + ')';
                    obj['weight'] = '0';

                    let mydataMarker = L.circleMarker([parseFloat(latarr[index]), parseFloat(lonarr[
                        index])], obj).addTo(
                        map_16d19f0c4cb02d0360d2d91f78fb101a);
                    mydataMarker.bindPopup(item.toString());
                    if (item == maxdose) {
                        mydataMarker.openPopup();
                    }


                }

            } catch (error) {
                console.log(error);
                return;
            };

        });
    });




    var popup = L.popup();

    function onMapClick(e) {
        // popup
        //     .setLatLng(e.latlng)
        //     .setContent("You clicked the map at " + e.latlng.toString())
        //     .openOn(map_16d19f0c4cb02d0360d2d91f78fb101a);
        // let fileHandle;
        // document.getElementById('butOpenFile').addEventListener('click', async () => {
        //     // Destructure the one-element array.
        //     [fileHandle] = await window.showOpenFilePicker();
        //     console.log(fileHandle);
        //     // Do something with the file handle.
        // });
        try {
            e.layer.openPopup();

        } catch (error) {
            // console.log(error);
        }




    };

    const csvStringToArray = strData => {
        const objPattern = new RegExp(("(\\;|\\r?\\n|\\r|^)(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|([^\\;\\r\\n]*))"), "gi");
        let arrMatches = null,
            arrData = [
                []
            ];
        while (arrMatches = objPattern.exec(strData)) {
            if (arrMatches[1].length && arrMatches[1] !== ";") arrData.push([]);
            arrData[arrData.length - 1].push(arrMatches[2] ?
                arrMatches[2].replace(new RegExp("\"\"", "g"), "\"") :
                arrMatches[3]);
        }
        return arrData;
    }

    function onMouseMove(e) {
        document.getElementById("coordlatlng").innerHTML = e.latlng.toString();


    }

    map_16d19f0c4cb02d0360d2d91f78fb101a.on('click', onMapClick);
    map_16d19f0c4cb02d0360d2d91f78fb101a.on('mousemove', onMouseMove);


    var tile_layer_ec0c677b6367df196a132fd6fb0127a1 = L.tileLayer(
        "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}", {
            "attribution": "Tiles \u0026copy; Esri \u0026mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community - TENMAK NÜKEN 2022",
            "detectRetina": false,
            "maxNativeZoom": 18,
            "maxZoom": 22,
            "minZoom": 0,
            "noWrap": false,
            "opacity": 1,
            "subdomains": "abc",
            "tms": false
        }
    ).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);

    let fileHandle_log;

    document.getElementById('logkaydetbutton').addEventListener('click', async () => {
        try {
            async function writeFile(fileHandle, contents) {
                try {

                    // Support for Chrome 82 and earlier.
                    if (fileHandle.createWriter) {
                        // Create a writer (request permission if necessary).
                        const writer = await fileHandle.createWriter();
                        // Write the full length of the contents
                        await writer.write(0, contents);
                        // Close the file and write the contents to disk
                        await writer.close();
                        return;
                    }
                    // For Chrome 83 and later.
                    // Create a FileSystemWritableFileStream to write to.
                    const writable = await fileHandle.createWritable();
                    // Write the contents of the file to the stream.
                    await writable.write(contents);
                    // Close the file and write the contents to disk.
                    await writable.close();

                } catch (error) {
                    console.log("Writefile catched this: " + error.toString());
                    await writable.close();
                }

            }

            const fileHandle = await self.showSaveFilePicker({


                suggestedName: 'Tenmak_iha_log_' + new Date().toLocaleDateString() + '_' +
                    new Date()
                    .toLocaleTimeString() + '.txt',
                types: [{
                    description: 'Text documents',
                    accept: {
                        'text/plain': ['.txt'],
                    },
                }],
            });


            await writeFile(fileHandle, gelenveri);


        } catch (error) {
            console.log(error);
        }



    });

    document.getElementById('logacbutton').addEventListener('click', async () => {
        [fileHandle_log] = await window.showOpenFilePicker();
        const file = await fileHandle_log.getFile();
        const contents = await file.text();
        let logarray = contents.split('\n');

        let alltext = "";
        let lantan_geldi = false;
        let plastik_geldi = false;
        let lantan_count = 0;
        let plastik_count = 0;
        let lastlat = 40.05;
        let lastlon = 32.60;
        let total_count = 5.0;
        let ilksefer = true;

        logarray.forEach(value => {

            try {
                document.getElementById("gelenveriTextarea1").innerHTML = document
                    .getElementById("gelenveriTextarea1").innerHTML + value
                    .toString() + "\n";

                value = value.split(" ").slice(1, ).join(" ");
                console.log(value);


                let cihaz = value.split(" ")[0];
                if (cihaz == "g") {
                    if (((1 - Math.abs(lastlat / parseFloat(value.split(" ")[5]))) > 0.1) ||
                        ilksefer) {
                        map_16d19f0c4cb02d0360d2d91f78fb101a.panTo(new L.LatLng(parseFloat(value
                            .split(" ")[5]), parseFloat(value.split(" ")[6])));
                        ilksefer = false;
                    }
                    lastlat = parseFloat(value.split(" ")[5]);
                    lastlon = parseFloat(value.split(" ")[6]);

                } else if (cihaz == "l") {
                    lantan_count = parseFloat(value.split(" ")[3]);
                    lantan_geldi = true;
                } else if (cihaz == "p") {
                    plastik_count = parseFloat(value.split(" ")[3]);
                    plastik_geldi = true;
                };

                if (lantan_geldi && plastik_geldi) {

                    total_count = carpan * (lantan_count * 2) + (1 - carpan) * (
                        plastik_count * 2);
                    if (lastlat > 0.1) {
                        xycount.push([lastlat, lastlon, total_count]);
                    }
                    let carpim_count = Math.max(lantan_count, 1.0) * plastik_count;
                    let expcarpim_count = (Math.max(lantan_count, 1.0) ** myexp) * (plastik_count **
                        myexp);

                    let obj = {};

                    if (total_count > max_count.value) {
                        max_count.set(total_count);
                    };
                    if (carpim_count > max_carpim_count.value) {
                        max_carpim_count.set(carpim_count);
                    };
                    if (expcarpim_count > max_expcarpim_count.value) {
                        max_expcarpim_count.set(expcarpim_count);
                    };
                    if (lantan_count > max_lantan_count.value) {
                        max_lantan_count.set(lantan_count);
                    };
                    if (plastik_count > max_plastik_count.value) {
                        max_plastik_count.set(plastik_count);
                    };

                    let mymaxcount = 0;
                    let mycount = 0;
                    if (document.getElementById('markersetselect').value == "toplam") {
                        mymaxcount = max_count.value;
                        mycount = total_count;
                    } else if (document.getElementById('markersetselect').value == "carpim") {
                        mymaxcount = max_carpim_count.value;
                        mycount = carpim_count;
                    } else if (document.getElementById('markersetselect').value == "expcarpim") {
                        mymaxcount = max_expcarpim_count.value;
                        mycount = expcarpim_count;
                    } else if (document.getElementById('markersetselect').value == "lantan") {
                        mymaxcount = max_lantan_count.value;
                        mycount = lantan_count;
                    } else if (document.getElementById('markersetselect').value == "plastik") {
                        mymaxcount = max_plastik_count.value;
                        mycount = plastik_count;
                    };

                    let mypopup = "total: " + total_count.toString() + " l: " + lantan_count
                        .toString() + " p: " + plastik_count.toString() + " max: " + max_count
                        .value + " id: " + mymarkers.length;
                    lantan_geldi = false;
                    plastik_geldi = false;
                    obj['className'] = lantan_count.toString() + " " + plastik_count.toString();
                    lantan_count = 0;
                    plastik_count = 0;
                    // console.log(max_count.value);
                    obj['radius'] = '5';
                    obj['stroke'] = 'false';

                    obj['opacity'] = (document.getElementById('opacityRange').value / 100)
                        .toString();
                    obj['fillOpacity'] = (document.getElementById('opacityRange').value / 100)
                        .toString();
                    obj['color'] = 'rgb(' + myColormap(mycount / mymaxcount)[0] + ',' +
                        myColormap(mycount / mymaxcount)[1] + ',' + myColormap(
                            mycount / mymaxcount)[2] + ')';
                    obj['weight'] = '0';


                    // L.circleMarker([parseFloat(value.split(",")[0].split("-")[0]), parseFloat(value.split(",")[0].split("-")[1])], { 'radius': '5', 'stroke': 'false', 'color': 'rgb(RdYlBu(parseFloat(value.split(",")[1])/101)[0],RdYlBu(parseFloat(value.split(",")[1])/101)[1],RdYlBu(parseFloat(value.split(",")[1])/101)[2])', 'weight': '0' }).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);
                    let mycirclemarker = L.circleMarker([lastlat, lastlon], obj).addTo(markerGroup);

                    mycirclemarker.bindPopup(mypopup);
                    mymarkers.push(mycirclemarker);

                }


            } catch (error) {
                document.getElementById("gelenveriTextarea1").innerHTML = document
                    .getElementById("gelenveriTextarea1").innerHTML + new Date()
                    .toLocaleTimeString() + "." + new Date().getMilliseconds() + " " + error
                    .toString() +
                    "\n";
                // continue;
                // TODO: Handle non-fatal read error.
                return;
            };


        });
        // let event = new Event('change');
        // document.getElementById('colormapselect').options[0].selected = true;
        // document.getElementById('colormapselect').dispatchEvent(event);
        // console.log(document.getElementById('colormapselect').value);
        // document.getElementById('colormapselect').options[1].selected = true;
        // document.getElementById('colormapselect').dispatchEvent(event);
    });




    document.getElementById('hexbinbutton').addEventListener('click', async () => {


        var myjsondata = {
            "type": "FeatureCollection",
            "name": "oz2",
            "crs": {
                "type": "name",
                "properties": {
                    "name": "urn:ogc:def:crs:OGC:1.3:CRS84"
                }
            },
            "features": [{
                    "type": "Feature",
                    "properties": {
                        "id": 1,
                        "Sozlesme": "T12-ASD-FG",
                        "Kiraci": "Oguzhan Ak",
                        "Bolge": 2,
                        "AcıkAlan": 20,
                        "KapalıAlan": 10,
                        "KiraBedel": 500,
                        "KullanımA": "Berber",
                        "AdaParsel": "100/1",
                        "il": "Ankara",
                        "ilce": "Altındag",
                        "YerT_T": "2017-06-01",
                        "Sozlesme_t": "2017-06-01",
                        "Sozlesme_b": "2022-11-16",
                        "Tahakkuk": "2022-06-14",
                        "Odeme": "2022-06-30",
                        "Parsel_d": 1
                    },
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [32.843433625716969, 39.936347636391929],
                                    [32.843529021994293, 39.936294439378109],
                                    [32.843489996244486, 39.936249000229381],
                                    [32.843388818374585, 39.93629998073564],
                                    [32.843433625716969, 39.936347636391929]
                                ]
                            ]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "id": 2,
                        "Sozlesme": "tr-12-123213",
                        "Kiraci": "Altındag B",
                        "Bolge": 2,
                        "AcıkAlan": 15,
                        "KapalıAlan": 200,
                        "KiraBedel": 500,
                        "KullanımA": "otopark",
                        "AdaParsel": "100/2",
                        "il": "Ankara",
                        "ilce": "Cankaya",
                        "YerT_T": "2019-06-13",
                        "Sozlesme_t": "2019-06-12",
                        "Sozlesme_b": "2022-06-10",
                        "Tahakkuk": "2022-06-13",
                        "Odeme": "2022-06-14",
                        "Parsel_d": 2
                    },
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [32.844587776132883, 39.935720352306284],
                                    [32.844735206743302, 39.935893243900296],
                                    [32.84488841894629, 39.935795715362509],
                                    [32.844720752761887, 39.935627256651671],
                                    [32.844587776132883, 39.935720352306284]
                                ]
                            ]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "id": 3,
                        "Sozlesme": "tr-5454",
                        "Kiraci": "Ahmet B",
                        "Bolge": 2,
                        "AcıkAlan": 100,
                        "KapalıAlan": 100,
                        "KiraBedel": 5000,
                        "KullanımA": "Büfe",
                        "AdaParsel": "100/3",
                        "il": "Ankara",
                        "ilce": "Cankaya",
                        "YerT_T": "2019-06-14",
                        "Sozlesme_t": "2019-06-13",
                        "Sozlesme_b": "2022-06-22",
                        "Tahakkuk": "2022-06-07",
                        "Odeme": "2022-06-14",
                        "Parsel_d": 2
                    },
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [32.852856176200746, 39.929165111319435],
                                    [32.852955908672499, 39.929158460997137],
                                    [32.852948681681788, 39.929118559049776],
                                    [32.852840276821176, 39.929125209375947],
                                    [32.852856176200746, 39.929165111319435]
                                ]
                            ]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "id": 4,
                        "Sozlesme": "tr-12-33",
                        "Kiraci": "Umut Tor",
                        "Bolge": 1,
                        "AcıkAlan": 12,
                        "KapalıAlan": 323,
                        "KiraBedel": 44444,
                        "KullanımA": "lostra",
                        "AdaParsel": "100/5",
                        "il": "Istanbul",
                        "ilce": "qwewqe",
                        "YerT_T": "2018-06-16",
                        "Sozlesme_t": "2018-06-19",
                        "Sozlesme_b": "2025-06-13",
                        "Tahakkuk": "2022-06-07",
                        "Odeme": "2022-06-08",
                        "Parsel_d": 2
                    },
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [29.04915799049617, 40.978711014916563],
                                    [29.049290967125177, 40.978643359980289],
                                    [29.049259168366074, 40.978590981917471],
                                    [29.04910884695936, 40.97864990723523],
                                    [29.04915799049617, 40.978711014916563]
                                ]
                            ]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "id": 5,
                        "Sozlesme": "rtr545",
                        "Kiraci": "Haydar",
                        "Bolge": 1,
                        "AcıkAlan": 34,
                        "KapalıAlan": 43,
                        "KiraBedel": 333,
                        "KullanımA": "cay",
                        "AdaParsel": "100/6",
                        "il": "Istanbul",
                        "ilce": "Kadıköy",
                        "YerT_T": "2021-12-16",
                        "Sozlesme_t": "2021-06-13",
                        "Sozlesme_b": "2025-06-13",
                        "Tahakkuk": "2022-06-14",
                        "Odeme": null,
                        "Parsel_d": 2
                    },
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [29.029902396456535, 40.999687245141985],
                                    [29.030032482289261, 40.999667609641044],
                                    [29.029931304419364, 40.999388348550085],
                                    [29.029833017345741, 40.999425437981856],
                                    [29.029902396456535, 40.999687245141985]
                                ]
                            ]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "id": 6,
                        "Sozlesme": "errr",
                        "Kiraci": "Mahmut",
                        "Bolge": 6,
                        "AcıkAlan": 22,
                        "KapalıAlan": 22,
                        "KiraBedel": 600,
                        "KullanımA": "12",
                        "AdaParsel": "233/1",
                        "il": "Adana",
                        "ilce": "Seyhan",
                        "YerT_T": "2022-06-09",
                        "Sozlesme_t": "2022-06-16",
                        "Sozlesme_b": "2022-06-15",
                        "Tahakkuk": "2022-06-23",
                        "Odeme": "2022-06-14",
                        "Parsel_d": 2
                    },
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [35.317664718755317, 37.003568460269292],
                                    [35.318017395901819, 37.003637717763944],
                                    [35.318040522272078, 37.003559225931902],
                                    [35.317679172736739, 37.003489968365727],
                                    [35.317664718755317, 37.003568460269292]
                                ]
                            ]
                        ]
                    }
                }
            ]
        }
        map_16d19f0c4cb02d0360d2d91f78fb101a.panTo(new L.LatLng(39.936347636391929, 32.843433625716969));

        myjsondata.features.forEach(element => {
            console.log(parseFloat(Date.parse(element.properties.Odeme) - Date.parse((element
                .properties.Tahakkuk))) / (1000 * 60 * 60 * 24))
            var mylatlon = []
            element.geometry.coordinates[0][0].forEach(element2 => {
                mylatlon.push([element2[1], element2[0]])
            });
            console.log(mylatlon)

            if (parseFloat(Date.parse(element.properties.Odeme) - Date.parse((element.properties
                    .Tahakkuk))) / (1000 * 60 * 60 * 24) <= 7) {
                let obj = {};
                obj['color'] = "blue";
                obj['weight'] = 1;
                var poly = L.polygon(mylatlon, obj).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a)
                poly.bindPopup(element.properties.Odeme)
            } else {
                let obj = {};
                obj['color'] = "red";
                var poly = L.polygon(mylatlon, obj).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a)
                poly.bindPopup(element.properties.Odeme)
            }

        });

        console.log(myjsondata.features["coordinates"])



















        // function utmzone_from_lon(lon_deg) {
        //     //get utm-zone from longitude degrees
        //     return parseInt(((lon_deg + 180) / 6) % 60) + 1;
        // }

        // function proj4_setdef(lon_deg) {
        //     //get UTM projection definition from longitude
        //     const utm_zone = utmzone_from_lon(lon_deg);
        //     const zdef = `+proj=utm +zone=${utm_zone} +datum=WGS84 +units=m +no_defs`;
        //     return zdef;
        // }

        // // computation test
        // let lon_input =  32.602;
        // let lat_input = 40.0595;
        // console.log("Input (long,lat):", lon_input, lat_input);
        // const azone = utmzone_from_lon(lon_input);
        // console.log(`UTM zone from longitude: ${azone}`);
        // console.log("AUTO projection definition:", proj4_setdef(lon_input));

        // // define proj4_defs for easy uses
        // // "EPSG:4326" for long/lat degrees, no projection
        // // "EPSG:AUTO" for UTM 'auto zone' projection
        // proj4.defs([
        //     [
        //         "EPSG:4326",
        //         "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"
        //     ],
        //     ["EPSG:AUTO", proj4_setdef(lon_input)]]);

        // // usage:
        // // conversion from (long/lat) to UTM (E/N)
        // const en_m = proj4("EPSG:4326", "EPSG:AUTO", [lon_input, lat_input]);
        // const e4digits = en_m[0].toFixed(4); //easting
        // const n4digits = en_m[1].toFixed(4); //northing
        // console.log(`Zone ${azone}, (E,N) m: ${e4digits}, ${n4digits}`);

        // // inversion from (E,N) to (long,lat)
        // const lonlat_chk = proj4("EPSG:AUTO", "EPSG:4326", en_m);
        // console.log("Inverse check:", lonlat_chk);













        //###################### heatmap.js ##################################################

        // var cfg = {
        //     // radius should be small ONLY if scaleRadius is true (or small radius is intended)
        //     "radius": 0.00002,
        //     "maxOpacity": .8,
        //     // scales the radius based on map zoom
        //     "scaleRadius": true,
        //     // if set to false the heatmap uses the global maximum for colorization
        //     // if activated: uses the data maximum within the current map boundaries 
        //     //   (there will always be a red spot with useLocalExtremas true)
        //     "useLocalExtrema": false,
        //     // which field name in your data represents the latitude - default "lat"
        //     latField: 'lat',
        //     // which field name in your data represents the longitude - default "lng"
        //     lngField: 'lng',
        //     // which field name in your data represents the data value - default "value"
        //     valueField: 'count'
        // };


        // var heatmapLayer = new HeatmapOverlay(cfg).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);

        // // var map = new L.Map('map', {
        // //   center: new L.LatLng(25.6586, -80.3568),
        // //   zoom: 4,
        // //   layers: [baseLayer, heatmapLayer]
        // // });~



        // console.log(xycount.length);    
        // heatmapLayer.setData(xycount);

        // make accessible for debugging
        // layer = heatmapLayer;
        // Create the hexbin layer and set all of the accessor functions

        //###################### hexbinlayer ##################################################

        // var options = {
        //     radius: 12,
        //     opacity: 0.8,
        //     duration: 200,

        //     colorScaleExtent: [1, undefined],
        //     radiusScaleExtent: [1, undefined],
        //     colorDomain: null,
        //     radiusDomain: null,
        //     colorRange: ["transparent", "#69b3a2"],
        //     radiusRange: [5, 12],

        //     pointerEvents: 'all'
        // };
        // var hexLayer = L.hexbinLayer(options).hoverHandler(L.HexbinHoverHandler.tooltip()).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);
        // const inputForHexbinFun = []
        // // coord_lat = 40.0595 + 0.000005 / 25 ;
        // // coord_lon = 32.602 + 0.00001 / 60 ;
        // var d_delta = 0.0005 / 25;
        // for (let d_lat = 40.0595; d_lat < 40.06; d_lat = d_lat + d_delta) {
        //     for (let d_lon = 32.602; d_lon < 32.603; d_lon = d_lon + d_delta) {
        //         inputForHexbinFun.push([d_lon, d_lat]);
        //     }
        // }
        // // console.log(inputForHexbinFun);
        // // Reformat the data: d3.hexbin() needs a specific format



        // xycount.forEach(function (onecount) {
        //     // console.log(inputForHexbinFun.length)
        //     // inputForHexbinFun.push([onecount[1], onecount[0]])  // Note that we had the transform value of X and Y !
        //     inputForHexbinFun.push([onecount[1], onecount[0]])  // Note that we had the transform value of X and Y !
        // })
        // // console.log(inputForHexbinFun);
        // hexLayer.data(inputForHexbinFun);

        // //###################### hexbinlayer ##################################################
        // const arrayColumn = (arr, n) => arr.map(x => x[n]);


        // // read data
        // // let targt = arrayColumn(xycount, 2);
        // // let lats = arrayColumn(xycount, 0);
        // // let lons = arrayColumn(xycount, 1);



        // // var t = [ /* Target variable */];
        // // var x = [ /* X-axis coordinates */];
        // // var y = [ /* Y-axis coordinates */];
        // console.log(Math.max(...arrayColumn(xycount, 2)));
        // var t = arrayColumn(xycount, 2).map(function (item) { return item / Math.max(...arrayColumn(xycount, 2)) });
        // var x = arrayColumn(xycount, 1);
        // var y = arrayColumn(xycount, 0);
        // var model = "exponential";
        // var sigma2 = 0, alpha = 100;
        // var variogram = kriging.train(t, x, y, model, sigma2, alpha);
        // console.log(variogram);
        // // var canvas = document.body.appendChild(document.createElement("canvas"));
        // // var ctx = canvas.getContext("2d");
        // // kriging.plot(canvas, );

        // for (let d_lat = 40.0595; d_lat < 40.06; d_lat = d_lat + d_delta) {
        //     for (let d_lon = 32.602; d_lon < 32.603; d_lon = d_lon + d_delta) {
        //         // console.log(kriging.predict(d_lat, d_lon, variogram));
        //         console.log(kriging.predict(d_lon, d_lat, variogram));
        //     }
        // }
        //         var xnew, ynew /* Pair of new coordinates to predict */;
        //   var tpredicted = kriging.predict(xnew, ynew, variogram);

        // Set the data (can be set multiple times)
        // hexLayer.data([[lng1, lat1], [lng2, lat2], ... [lngN, latN]]);



        // markerGroup.clearLayers();
        // // Use Leaflets projection API for drawing svg path (creates a stream of projected points)
        // const projectPoint = function (x, y) {
        //     const point = map.latLngToLayerPoint(new L.LatLng(y, x))
        //     this.stream.point(point.x, point.y)
        // }

        // // Use d3's custom geo transform method to implement the above
        // const projection = d3.geoTransform({ point: projectPoint });

        // // creates geopath from projected points (SVG)
        // // const pathCreator = d3.geoPath().projection(projection);
        // hexbin.hexagon(d.length)

        // const arrayColumn = (arr, n) => arr.map(x => x[n]);


        // // read data
        // let lats = arrayColumn(xycount, 0);
        // let lons = arrayColumn(xycount, 1);

        // var corner1 = L.latLng(Math.min(...lats), Math.min(...lons)),
        //     corner2 = L.latLng(Math.max(...lats), Math.max(...lons)),
        //     bounds = L.latLngBounds(corner1, corner2);
        // // set the dimensions and margins of the graph
        // const margin = { top: 10, right: 30, bottom: 30, left: 40 },
        //     width = (Math.max(...lats) - Math.min(...lats)) * 100000,
        //     height = (Math.max(...lons) - Math.min(...lons)) * 100000;



        // L.svg({ clickable: true }).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a)// we have to make the svg layer clickable

        // const overlay = d3.select(map_16d19f0c4cb02d0360d2d91f78fb101a.getPanes().overlayPane)
        // const svg = overlay.select('svg');
        // //     .attr("width", height)
        // //     .attr("height", width);
        // // .attr("cx", d => map_16d19f0c4cb02d0360d2d91f78fb101a.latLngToLayerPoint([d.geometry.coordinates[1], d.geometry.coordinates[0]]).x)
        // // .attr("cy", d => map_16d19f0c4cb02d0360d2d91f78fb101a.latLngToLayerPoint([d.geometry.coordinates[1], d.geometry.coordinates[0]]).y);
        // //  L.svgOverlay(svg,bounds).addTo(map_16d19f0c4cb02d0360d2d91f78fb101a);
        // const g = svg.append('g').attr('class', 'leaflet-zoom-hide');


        // // append the svg object to the body of the page
        // const svg = d3.select("#my_dataviz")
        //     .append("svg")
        //     .attr("width", width + margin.left + margin.right)
        //     .attr("height", height + margin.top + margin.bottom)
        //     .append("g")
        //     .attr("transform", `translate(${margin.left}, ${margin.top})`);


        // console.log(xycount);
        // console.log(Math.min(...lats));
        // console.log(Math.max(...lats) - Math.min(...lats));
        // // Add X axis
        // const x = d3.scaleLinear()
        //     .domain([Math.min(...lons), Math.max(...lons)])
        //     .range([0, width]);
        // svg.append("g")
        //     .attr("transform", `translate(0, ${height})`)
        //     .call(d3.axisBottom(x));

        // // // Add Y axis
        // const y = d3.scaleLinear()
        //     .domain([Math.min(...lats), Math.max(...lats)])
        //     .range([height, 0]);
        // svg.append("g")
        //     .call(d3.axisLeft(y));



        // // Prepare a color palette
        // const color = d3.scaleLinear()
        //     .domain([0, 10]) // Number of points in the bin?
        //     .range(["transparent", "#69b3a2"])

        // // Compute the hexbin data
        // const hexbin = d3.hexbin()
        //     .radius(0.00001) // size of the bin in px
        // // .extent([[0, 0], [width, height]])

        // // Plot the hexbins
        // // svg.append("clipPath")
        // //     .attr("id", "clip")
        // //     .append("rect")
        // //     .attr("width", width)
        // //     .attr("height", height)
        // console.log(inputForHexbinFun);

        // // const areaPaths = svg.append("g")
        // //     .attr("clip-path", "url(#clip)")
        // //     .selectAll("path")
        // //     .data(hexbin(inputForHexbinFun)[0])
        // //     .join("path")
        // //     .attr("d", hexbin.hexagon())
        // //     // .attr("transform", function (d) { return `translate(${d.x}, ${d.y})` })
        // //     .attr("fill", function (d) { return color(d.length); })
        // //     .attr("stroke", "black")
        // //     .attr("stroke-width", "0.1")
        // const radius = d3.scaleSqrt([0, d3.max(hexbin(inputForHexbinFun), d => d.length)], [0, hexbin.radius() * Math.SQRT2])
        // console.log(hexbin(inputForHexbinFun))
        // const areaPaths = svg.append("g")
        //     .selectAll("path")
        //     .data(hexbin(inputForHexbinFun))
        //     .join("path")
        //     .attr("transform",function (d) { `translate(${d.x},${d.y})`;
        // console.log(d.x)})
        //     .attr("d", d => hexbin.hexagon(d.length))
        //     .attr("fill", function (d) {
        //         console.log(d.length)
        //         return color(d.length);
        //     })
        //     .attr("stroke", "black")
        //     .attr("stroke-width", "0.1")


        // const onZoom = () => areaPaths.attr('d', pathCreator)
        // // initialize positioning
        // onZoom()

        // // reset whenever map is moved
        // map_16d19f0c4cb02d0360d2d91f78fb101a.on('zoomend', onZoom)

    });
</script>